(()=>{"use strict";var e,n={170:function(e,n,t){var s=this&&this.__awaiter||function(e,n,t,s){return new(t||(t=Promise))((function(i,o){function a(e){try{d(s.next(e))}catch(e){o(e)}}function r(e){try{d(s.throw(e))}catch(e){o(e)}}function d(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,r)}d((s=s.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const i=t(542),o=t(147),a=t(683),r=t(657),d=t(887),l=t(465),c=t(707),u=new o.default;class m{constructor(e){this.messageListener=e}sendMessage(e,n,t){this.messageListener?this.messageListener(n,null,t):chrome.tabs?chrome.tabs.sendMessage(e,n,t):chrome.runtime.sendMessage({message:"tabs",data:n},t)}query(e,n){this.messageListener||!chrome.tabs?n([{url:document.URL,id:-1}]):chrome.tabs.query(e,n)}}let p=window===window.top;window.addEventListener("message",(e=>s(void 0,void 0,void 0,(function*(){if(e.source===window.parent)return e.origin.endsWith(".youtube.com")?p=!0:void 0})))),function(e){s(this,void 0,void 0,(function*(){const e=new m(undefined);(0,c.localizeHtmlPage)();let n=!1,t=[],o=null;const g={};["sponsorblockPopup","sponsorStart","whitelistChannel","unwhitelistChannel","whitelistToggle","whitelistForceCheck","disableSkipping","enableSkipping","toggleSwitch","showNoticeAgain","optionsButton","helpButton","submitTimes","sponsorTimesContributionsContainer","sponsorTimesContributionsDisplay","sponsorTimesViewsContainer","sponsorTimesViewsDisplay","sponsorTimesViewsDisplayEndWord","sponsorTimesOthersTimeSavedDisplay","sponsorTimesOthersTimeSavedEndWord","sponsorTimesSkipsDoneContainer","sponsorTimesSkipsDoneDisplay","sponsorTimesSkipsDoneEndWord","sponsorTimeSavedDisplay","sponsorTimeSavedEndWord","setUsernameContainer","setUsernameButton","setUsernameStatus","setUsernameStatus","setUsername","usernameInput","usernameValue","submitUsername","sbPopupIconCopyUserID","submissionHint","mainControls","loadingIndicator","videoFound","sponsorMessageTimes","refreshSegmentsButton","whitelistButton","sbDonate","sponsorTimesDonateContainer","sbConsiderDonateLink","sbCloseDonate","sbBetaServerWarning","sbCloseButton"].forEach((e=>g[e]=document.getElementById(e))),e.query({active:!0,currentWindow:!0},(a=>function(a,r){e.sendMessage(a[0].id,{message:"getVideoID"},(function(r){void 0!==r&&r.videoID?(o=r.videoID,n=r.creatingSegment,function(n,a){var r;s(this,void 0,void 0,(function*(){o?(yield u.wait((()=>null!==i.default.config),5e3,10),t=null!==(r=i.default.config.unsubmittedSegments[o])&&void 0!==r?r:[],T(),e.sendMessage(n[0].id,{message:"isInfoFound",updating:false},f)):b()}))}(a)):void 0===r&&chrome.runtime.lastError&&b()}))}(a))),yield u.wait((()=>null!==i.default.config&&p),5e3,5),document.querySelector("body").style.removeProperty("visibility"),i.default.configSyncListeners.includes(M)||i.default.configSyncListeners.push(M),g.sbCloseButton.addEventListener("click",(()=>{w({message:"closePopup"})})),window!==window.top&&g.sbCloseButton.classList.remove("hidden"),(0,r.showDonationLink)()||(g.sbDonate.style.display="none"),g.sbDonate.addEventListener("click",(()=>i.default.config.donateClicked=i.default.config.donateClicked+1)),i.default.config.testingServer&&(g.sbBetaServerWarning.classList.remove("hidden"),g.sbBetaServerWarning.addEventListener("click",(function(){C("advanced")}))),g.sponsorStart.addEventListener("click",(function(){e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{from:"popup",message:"sponsorStart"},(e=>s(this,void 0,void 0,(function*(){v(e);const n=e=>{const n=i.default.configSyncListeners.indexOf(e);-1!==n&&i.default.configSyncListeners.splice(n,1)},t=()=>{v(e),n(t)};i.default.configSyncListeners.push(t),setTimeout((()=>n(t)),200)}))))}))})),g.whitelistToggle.addEventListener("change",(function(){this.checked?e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"getChannelID"},(function(n){if(!n.channelID)return void alert(chrome.i18n.getMessage("channelDataNotFound")+" https://github.com/ajayyy/SponsorBlock/issues/753");let t=i.default.config.whitelistedChannels;null==t&&(t=[]),t.push(n.channelID),g.whitelistChannel.style.display="none",g.unwhitelistChannel.style.display="unset",document.querySelectorAll(".SBWhitelistIcon")[0].classList.add("rotated"),i.default.config.forceChannelCheck||g.whitelistForceCheck.classList.remove("hidden"),i.default.config.whitelistedChannels=t,e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"whitelistChange",value:!0})}))}))})):e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"getChannelID"},(function(n){let t=i.default.config.whitelistedChannels;null==t&&(t=[]);const s=t.indexOf(n.channelID);t.splice(s,1),g.whitelistChannel.style.display="unset",g.unwhitelistChannel.style.display="none",document.querySelectorAll(".SBWhitelistIcon")[0].classList.remove("rotated"),g.whitelistForceCheck.classList.add("hidden"),i.default.config.whitelistedChannels=t,e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"whitelistChange",value:!1})}))}))}))})),g.whitelistForceCheck.addEventListener("click",(()=>{C("behavior")})),g.toggleSwitch.addEventListener("change",(function(){!function(e){i.default.config.disableSkipping=e;let n=g.disableSkipping,t=g.enableSkipping;e||(n=g.enableSkipping,t=g.disableSkipping),t.style.display="unset",n.style.display="none"}(!this.checked)})),g.submitTimes.addEventListener("click",(function(){t.length>0&&e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"submitTimes"})}))})),g.showNoticeAgain.addEventListener("click",(function(){i.default.config.dontShowNotice=!1,g.showNoticeAgain.style.display="none"})),g.setUsernameButton.addEventListener("click",S),g.usernameValue.addEventListener("click",S),g.submitUsername.addEventListener("click",(function(){g.setUsernameStatus.style.display="unset",g.setUsernameStatus.innerText=chrome.i18n.getMessage("Loading"),u.sendRequestToServer("POST","/api/setUsername?userID="+i.default.config.userID+"&username="+g.usernameInput.value,(function(e){200==e.status?(g.submitUsername.style.display="none",g.usernameInput.style.display="none",g.setUsernameContainer.style.removeProperty("display"),g.setUsername.classList.remove("SBExpanded"),g.usernameValue.innerText=g.usernameInput.value,g.setUsernameStatus.style.display="none",g.sponsorTimesContributionsContainer.classList.remove("hidden")):g.setUsernameStatus.innerText=l.GenericUtils.getErrorMessage(e.status,e.responseText)})),g.setUsernameContainer.style.display="none",g.setUsername.style.display="unset"})),g.optionsButton.addEventListener("click",(function(){chrome.runtime.sendMessage({message:"openConfig"})})),g.helpButton.addEventListener("click",(function(){chrome.runtime.sendMessage({message:"openHelp"})})),g.refreshSegmentsButton.addEventListener("click",(function(){const n=d.AnimationUtils.applyLoadingAnimation(g.refreshSegmentsButton,.3);e.query({active:!0,currentWindow:!0},(t=>{e.sendMessage(t[0].id,{message:"refreshSegments"},(e=>{f(e),n()}))}))})),g.sbPopupIconCopyUserID.addEventListener("click",(()=>s(this,void 0,void 0,(function*(){return E(yield u.getHash(i.default.config.userID))})))),window!==window.top&&document.addEventListener("keydown",(e=>{const n=e.target;"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&(" "===e.key&&e.preventDefault(),w({message:"keydown",key:e.key,keyCode:e.keyCode,code:e.code,which:e.which,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey}))}));const h=i.default.config.disableSkipping;null!=h&&h&&(g.disableSkipping.style.display="none",g.enableSkipping.style.display="unset",g.toggleSwitch.checked=!1);const y=i.default.config.dontShowNotice;function f(n){chrome.runtime.lastError?b():(null!=n&&(g.mainControls.style.display="block",n.onMobileYouTube&&g.mainControls.classList.add("hidden"),g.whitelistButton.classList.remove("hidden"),g.loadingIndicator.style.display="none",n.found?(g.videoFound.innerHTML=chrome.i18n.getMessage("sponsorFound"),function(n){var t;if(null!=n.sponsorTimes){const s=n.sponsorTimes.sort(((e,n)=>e.segment[1]-n.segment[1])).sort(((e,n)=>e.segment[0]-n.segment[0])),o=document.getElementById("issueReporterTimeButtons");for(;o.firstChild;)o.removeChild(o.firstChild);const r=i.default.config.isVip;for(let n=0;n<s.length;n++){const l=s[n].UUID,c=s[n].locked,m=document.createElement("summary");m.className="segmentSummary";const p=document.createElement("span");p.id="sponsorTimesCategoryColorCircle"+l,p.style.backgroundColor=null===(t=i.default.config.barTypes[s[n].category])||void 0===t?void 0:t.color,p.classList.add("dot"),p.classList.add("sponsorTimesCategoryColorCircle");let g="";s[n].hidden===a.SponsorHideType.Downvoted?g=" ("+chrome.i18n.getMessage("hiddenDueToDownvote")+")":s[n].hidden===a.SponsorHideType.MinimumDuration?g=" ("+chrome.i18n.getMessage("hiddenDueToDuration")+")":s[n].hidden===a.SponsorHideType.Hidden&&(g=" ("+chrome.i18n.getMessage("manuallyHidden")+")");const h=document.createTextNode(u.shortCategoryName(s[n].category)+g),y=document.createElement("div");s[n].actionType===a.ActionType.Full?y.innerText=chrome.i18n.getMessage("full"):y.innerText=u.getFormattedTime(s[n].segment[0],!0)+(s[n].actionType!==a.ActionType.Poi?" "+chrome.i18n.getMessage("to")+" "+u.getFormattedTime(s[n].segment[1],!0):""),y.style.margin="5px";const f=document.createElement("div");f.appendChild(p);const v=document.createElement("span");v.className="summaryLabel",v.appendChild(h),f.appendChild(v),m.appendChild(f),m.appendChild(y);const T=document.createElement("details");T.classList.add("votingButtons");const C=document.createElement("div");C.id="sponsorTimesVoteButtonsContainer"+l,C.classList.add("sbVoteButtonsContainer");const w=document.createElement("img");w.id="sponsorTimesUpvoteButtonsContainer"+l,w.className="voteButton",w.title=chrome.i18n.getMessage("upvote"),w.src=chrome.runtime.getURL("icons/thumbs_up.svg"),w.addEventListener("click",(()=>L(1,l)));const S=document.createElement("img");S.id="sponsorTimesDownvoteButtonsContainer"+l,S.className="voteButton",S.title=chrome.i18n.getMessage("downvote"),S.src=c&&r?chrome.runtime.getURL("icons/thumbs_down_locked.svg"):chrome.runtime.getURL("icons/thumbs_down.svg"),S.addEventListener("click",(()=>L(0,l)));const b=document.createElement("img");b.id="sponsorTimesCopyUUIDButtonContainer"+l,b.className="voteButton",b.src=chrome.runtime.getURL("icons/clipboard.svg"),b.title=chrome.i18n.getMessage("copySegmentID"),b.addEventListener("click",(()=>{E(l),d.AnimationUtils.applyLoadingAnimation(b,.3)()}));const k=document.createElement("img");k.id="sponsorTimesCopyUUIDButtonContainer"+l,k.className="voteButton",k.title=chrome.i18n.getMessage("hideSegment"),s[n].hidden===a.SponsorHideType.Hidden?k.src=chrome.runtime.getURL("icons/not_visible.svg"):k.src=chrome.runtime.getURL("icons/visible.svg"),k.addEventListener("click",(()=>{d.AnimationUtils.applyLoadingAnimation(k,.4)(),s[n].hidden===a.SponsorHideType.Hidden?(k.src=chrome.runtime.getURL("icons/visible.svg"),s[n].hidden=a.SponsorHideType.Visible):(k.src=chrome.runtime.getURL("icons/not_visible.svg"),s[n].hidden=a.SponsorHideType.Hidden),e.query({active:!0,currentWindow:!0},(t=>{e.sendMessage(t[0].id,{message:"hideSegment",type:s[n].hidden,UUID:l})}))})),C.appendChild(w),C.appendChild(S),C.appendChild(b),s[n].actionType===a.ActionType.Skip&&[a.SponsorHideType.Visible,a.SponsorHideType.Hidden].includes(s[n].hidden)&&C.appendChild(k);const D=document.createElement("div");D.id="sponsorTimesVoteStatusContainer"+l,D.classList.add("sponsorTimesVoteStatusContainer"),D.style.display="none";const M=document.createElement("div");M.id="sponsorTimesThanksForVotingText"+l,M.classList.add("sponsorTimesThanksForVotingText"),D.appendChild(M),T.append(m),T.append(C),T.append(D),o.appendChild(T)}}}(n)):404==n.status||200==n.status?g.videoFound.innerHTML=chrome.i18n.getMessage("sponsor404"):g.videoFound.innerHTML=chrome.i18n.getMessage("connectionError")+n.status),e.query({active:!0,currentWindow:!0},(n=>{e.sendMessage(n[0].id,{message:"isChannelWhitelisted"},(function(e){e.value&&(g.whitelistChannel.style.display="none",g.unwhitelistChannel.style.display="unset",g.whitelistToggle.checked=!0,document.querySelectorAll(".SBWhitelistIcon")[0].classList.add("rotated"))}))})))}function v(e){n=e.creatingSegment,n||(t=i.default.config.unsubmittedSegments[o]||[]),T()}function T(){g.sponsorStart.innerText=chrome.i18n.getMessage(n?"sponsorEnd":"sponsorStart"),g.submitTimes.style.display=t&&t.length>0?"unset":"none",g.submissionHint.style.display=t&&t.length>0?"unset":"none"}function C(e){chrome.runtime.sendMessage({message:"openConfig",hash:e})}function w(n){return new Promise((t=>{e.query({active:!0,currentWindow:!0},(s=>{e.sendMessage(s[0].id,n,(e=>t(e)))}))}))}function S(){g.usernameInput.value=g.usernameValue.innerText,g.submitUsername.style.display="unset",g.usernameInput.style.display="unset",g.setUsernameContainer.style.display="none",g.setUsername.style.display="flex",g.setUsername.classList.add("SBExpanded"),g.setUsernameStatus.style.display="none",g.sponsorTimesContributionsContainer.classList.add("hidden")}function b(){document.getElementById("loadingIndicator").innerText=chrome.i18n.getMessage("noVideoID")}function k(e,n){document.getElementById("sponsorTimesVoteButtonsContainer"+n).style.display="none",document.getElementById("sponsorTimesVoteStatusContainer"+n).style.removeProperty("display"),document.getElementById("sponsorTimesThanksForVotingText"+n).innerText=e}function L(n,t){k(chrome.i18n.getMessage("Loading"),t),e.query({active:!0,currentWindow:!0},(s=>{e.sendMessage(s[0].id,{message:"submitVote",type:n,UUID:t},(function(e){null!=e&&(1==e.successType||-1==e.successType&&429==e.statusCode?k(chrome.i18n.getMessage("voted"),t):-1==e.successType&&k(l.GenericUtils.getErrorMessage(e.statusCode,e.responseText),t),setTimeout((()=>function(e){document.getElementById("sponsorTimesVoteButtonsContainer"+e).style.display="block",document.getElementById("sponsorTimesVoteStatusContainer"+e).style.display="none",document.getElementById("sponsorTimesThanksForVotingText"+e).removeAttribute("innerText")}(t)),1500))}))}))}function E(e){window===window.top?window.navigator.clipboard.writeText(e):w({message:"copyToClipboard",text:e})}function D(e){e=Math.round(10*e)/10;const n=Math.floor(e/1440),t=Math.floor(e/60)%24;return(n>0?n+chrome.i18n.getMessage("dayAbbreviation")+" ":"")+(t>0?t+chrome.i18n.getMessage("hourAbbreviation")+" ":"")+(e%60).toFixed(1)}function M(e){var n;for(const s in e)"unsubmittedSegments"===s&&(t=null!==(n=i.default.config.unsubmittedSegments[o])&&void 0!==n?n:[],T())}null!=y&&y&&(g.showNoticeAgain.style.display="unset"),u.sendRequestToServer("GET","/api/userInfo?value=userName&value=viewCount&value=minutesSaved&value=vip&userID="+i.default.config.userID,(e=>{if(200===e.status){const n=JSON.parse(e.responseText);g.usernameValue.innerText=n.userName;const t=n.viewCount;0!=t&&(g.sponsorTimesViewsDisplayEndWord.innerText=t>1?chrome.i18n.getMessage("Segments"):chrome.i18n.getMessage("Segment"),g.sponsorTimesViewsDisplay.innerText=t.toLocaleString(),g.sponsorTimesViewsContainer.style.display="block"),function(e){i.default.config.showDonationLink&&i.default.config.donateClicked<=0&&i.default.config.showPopupDonationCount<5&&e<5e4&&!i.default.config.isVip&&i.default.config.skipCount>10&&(g.sponsorTimesDonateContainer.style.display="flex",g.sbConsiderDonateLink.addEventListener("click",(()=>{i.default.config.donateClicked=i.default.config.donateClicked+1})),g.sbCloseDonate.addEventListener("click",(()=>{g.sponsorTimesDonateContainer.style.display="none",i.default.config.showPopupDonationCount=100})),i.default.config.showPopupDonationCount=i.default.config.showPopupDonationCount+1)}(t);const s=n.minutesSaved;0!=s&&(g.sponsorTimesOthersTimeSavedEndWord.innerText=1!=s?chrome.i18n.getMessage("minsLower"):chrome.i18n.getMessage("minLower"),g.sponsorTimesOthersTimeSavedDisplay.innerText=D(s)),i.default.config.isVip=n.vip}})),null!=i.default.config.sponsorTimesContributed&&(g.sponsorTimesContributionsDisplay.innerText=i.default.config.sponsorTimesContributed.toLocaleString(),g.sponsorTimesContributionsContainer.classList.remove("hidden")),null!=i.default.config.skipCount&&(1!=i.default.config.skipCount?g.sponsorTimesSkipsDoneEndWord.innerText=chrome.i18n.getMessage("Segments"):g.sponsorTimesSkipsDoneEndWord.innerText=chrome.i18n.getMessage("Segment"),g.sponsorTimesSkipsDoneDisplay.innerText=i.default.config.skipCount.toLocaleString(),g.sponsorTimesSkipsDoneContainer.style.display="block"),null!=i.default.config.minutesSaved&&(1!=i.default.config.minutesSaved?g.sponsorTimeSavedEndWord.innerText=chrome.i18n.getMessage("minsLower"):g.sponsorTimeSavedEndWord.innerText=chrome.i18n.getMessage("minLower"),g.sponsorTimeSavedDisplay.innerText=D(i.default.config.minutesSaved)),setTimeout((()=>g.sponsorblockPopup.classList.remove("preload")),250)}))}()}},t={};function s(e){var i=t[e];if(void 0!==i)return i.exports;var o=t[e]={exports:{}};return n[e].call(o.exports,o,o.exports,s),o.exports}s.m=n,e=[],s.O=(n,t,i,o)=>{if(!t){var a=1/0;for(c=0;c<e.length;c++){for(var[t,i,o]=e[c],r=!0,d=0;d<t.length;d++)(!1&o||a>=o)&&Object.keys(s.O).every((e=>s.O[e](t[d])))?t.splice(d--,1):(r=!1,o<a&&(a=o));if(r){e.splice(c--,1);var l=i();void 0!==l&&(n=l)}}return n}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[t,i,o]},s.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={42:0};s.O.j=n=>0===e[n];var n=(n,t)=>{var i,o,[a,r,d]=t,l=0;if(a.some((n=>0!==e[n]))){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(d)var c=d(s)}for(n&&n(t);l<a.length;l++)o=a[l],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(c)},t=self.webpackChunksponsorblock=self.webpackChunksponsorblock||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var i=s.O(void 0,[736],(()=>s(170)));i=s.O(i)})();